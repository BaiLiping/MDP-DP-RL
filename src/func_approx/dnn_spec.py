from typing import Callable, Sequence, NamedTuple
import numpy as np


class DNNSpec(NamedTuple):
    neurons: Sequence[int]
    hidden_activation: Callable[[np.ndarray], np.ndarray]
    hidden_activation_deriv: Callable[[np.ndarray], np.ndarray]
    output_activation: Callable[[np.ndarray], np.ndarray]
    output_activation_deriv: Callable[[np.ndarray], np.ndarray]

    @staticmethod
    def relu(arg: np.ndarray) -> np.ndarray:
        return np.vectorize(lambda x: x if x > 0. else 0.)(arg)

    @staticmethod
    def relu_deriv(res: np.ndarray) -> np.ndarray:
        return np.vectorize(lambda x: 1. if x > 0. else 0.)(res)

    @staticmethod
    def identity(arg: np.ndarray) -> np.ndarray:
        return arg

    @staticmethod
    def identity_deriv(res: np.ndarray) -> np.ndarray:
        return np.ones_like(res)
